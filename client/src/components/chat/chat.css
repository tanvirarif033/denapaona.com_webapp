/* --- Floating button --- */
.chat-fab{position:fixed;right:16px;bottom:16px;z-index:10010;border:none;border-radius:999px;padding:12px 16px;background:#111827;color:#fff;font-weight:600;box-shadow:0 8px 20px rgba(0,0,0,.25);cursor:pointer}

/* --- Overlay & panel --- */
.chat-overlay{position:fixed;inset:0;background:rgba(17,24,39,.5);opacity:0;pointer-events:none;transition:opacity .2s ease;z-index:10000}
.chat-overlay.open{opacity:1;pointer-events:auto}
.chat-panel{position:fixed;right:0;bottom:0;height:0;width:100%;max-width:420px;background:#fff;border-radius:16px 16px 0 0;box-shadow:0 -10px 30px rgba(0,0,0,.15);transform:translateY(100%);transition:transform .25s ease,height .25s ease;z-index:10005;display:grid;grid-template-rows:auto 1fr auto}
@media(min-width:768px){.chat-panel{right:16px;bottom:16px;height:560px;width:380px;max-width:none;border-radius:16px}}
.chat-panel.open{transform:translateY(0);height:calc(100dvh - 0px)}
@media(min-width:768px){.chat-panel.open{height:560px}}

/* --- Header --- */
.chat-header{display:flex;justify-content:space-between;align-items:center;padding:12px 14px;border-bottom:1px solid #eee;background:#f9fafb}
.chat-subtitle{font-size:12px;color:#6b7280;margin-top:2px}
.chat-close{background:transparent;border:0;font-size:18px;cursor:pointer;padding:6px}

/* --- Body (bubbles) --- */
.chat-body{overflow-y:auto;padding:12px;display:flex;flex-direction:column;gap:10px;scroll-behavior:smooth}
.chat-line{display:inline-flex;flex-direction:column;max-width:78%}
.chat-line.user{align-self:flex-end}          /* my messages -> right */
.chat-line.admin,.chat-line.system{align-self:flex-start} /* others -> left */
.chat-bubble{border-radius:12px;padding:8px 10px;line-height:1.4;word-break:break-word}
.chat-line.user .chat-bubble{background:#111827;color:#fff}
.chat-line.admin .chat-bubble{background:#f3f4f6;color:#111}
.chat-line.system .chat-bubble{background:#e5e7eb;color:#111}
.chat-image img{max-width:min(240px,60vw);border-radius:10px;display:block}
.chat-time{font-size:11px;color:#9ca3af;margin-top:4px}

/* --- Input bar --- */
.chat-inputbar{position:relative;display:grid;grid-template-columns:auto auto 1fr auto;gap:8px;align-items:center;padding:8px;border-top:1px solid #eee;background:#fff}
.icon-btn{background:transparent;border:0;font-size:20px;cursor:pointer;padding:6px;border-radius:8px}
.icon-btn.active{background:#f3f4f6}
.chat-text{width:100%;border:1px solid #e5e7eb;border-radius:10px;padding:10px 12px;outline:none}
.chat-text:focus{border-color:#cbd5e1}
.send-btn{background:#111827;color:#fff;border:0;border-radius:10px;padding:8px 12px;cursor:pointer}
.send-btn:disabled{opacity:.5;cursor:not-allowed}

/* --- Emoji popover --- */
.emoji-popover{position:absolute;bottom:56px;right:8px;width:min(360px,96vw);max-height:340px;overflow:hidden;border-radius:12px;box-shadow:0 12px 32px rgba(0,0,0,.18);background:#fff;z-index:5}
.emoji-popover-header{display:flex;align-items:center;justify-content:space-between;padding:8px 12px;border-bottom:1px solid #eee;font-weight:600;background:#fafafa}
.emoji-close{background:transparent;border:0;font-size:18px;cursor:pointer;padding:4px 6px}

/* --- Dark mode --- */
@media (prefers-color-scheme: dark){
  .chat-panel{background:#0b0f19;color:#e5e7eb}
  .chat-header{background:#0f1524;border-color:#1e293b}
  .chat-body{background:#0b0f19}
  .chat-inputbar{background:#0f1524;border-color:#1e293b}
  .chat-fab{background:#2563eb}
  .chat-line.admin .chat-bubble{background:#111827;color:#e5e7eb}
  .chat-line.system .chat-bubble{background:#1f2937;color:#e5e7eb}
  .chat-text{background:#0b0f19;color:#e5e7eb;border-color:#1e293b}
}